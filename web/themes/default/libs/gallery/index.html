<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">
    <title>Gallery</title>
    <link href="node_modules/mocha/mocha.css" type="text/css" rel="stylesheet" charset="utf-8">
    <script src="node_modules/seajs/dist/sea.js"></script>
    <script src="node_modules/mocha/mocha.js"></script>
    <script src="node_modules/expect.js/expect.js"></script>
    <script type="text/javascript">
      seajs.config({
        base: './',
        alias: {
          '$': 'jquery/dist/jquery'
        },
        map: [
          function(url) {
            var regex = /gallery\/(.*?)\/\d+\..*?\/(.*)$/
            return url.replace(regex, '$1/dist/$2')
          }
        ]
      });
    </script>
  </head>
  <body>
    <div id="mocha">Modules in Gallery</div>
    <script>
      (function() {
        mocha.setup('bdd');

        var modules = [
          'async', 'backbone', 'coffee', 'expect', 'handlebars',
          'iscroll', 'jquery', 'jsuri', 'keymaster',
          'labjs', 'less', 'marked', 'moment', 'mustache', 'selection',
          'store', 'swfobject', 'underscore', 'zepto', 'ztree',
          'juicer', 'morris'
        ]

        var specs = []
        for (var i = 0; i < modules.length; i++) {
          specs[i] = './' + modules[i] + '/spec.js'
        }

        seajs.use(specs, function() {
          if (window.mochaPhantomJS) {
            mochaPhantomJS.run()
          } else {
            mocha.run()
          }
        })
      })()
    </script>
  </body>
</html>
